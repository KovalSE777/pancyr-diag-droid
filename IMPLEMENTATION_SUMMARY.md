# –ò—Ç–æ–≥–∏ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç—É changor.docx

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. **–£–ª—É—á—à–µ–Ω –ø–∞—Ä—Å–µ—Ä –ø—Ä–æ—Ç–æ–∫–æ–ª–∞** (`src/utils/checksum.ts`)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `buildUDS()` ‚Äî —Å–æ–∑–¥–∞—ë—Ç UDS-–∫–∞–¥—Ä—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∑–∞–≥–æ–ª–æ–≤–∫–æ–º HDR = 0x80 | (B-2)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `ackUOKS()` ‚Äî —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç ASCII –æ—Ç–≤–µ—Ç –Ω–∞ –∫–∞–¥—Ä 0x66
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `ackUOKP()` ‚Äî —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç ASCII –æ—Ç–≤–µ—Ç –Ω–∞ –∫–∞–¥—Ä 0x77
- ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é —Å—É–º–º—É (mod 256)

### 2. **–°–æ–∑–¥–∞–Ω Live HEX Monitor** (`src/components/diagnostics/LiveHexMonitor.tsx`)
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –∫–∞–¥—Ä–æ–≤ (TX/RX) –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç HEX –¥–∞–Ω–Ω—ã–µ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ (—Å –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞–º–∏)
- ‚úÖ –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (TX ‚Äî —Å–∏–Ω–∏–π, RX ‚Äî –∑–µ–ª—ë–Ω—ã–π)
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º—ã (CHK ‚úì/‚úó)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è –∫–∞–¥—Ä–æ–≤

### 3. **–û–±–Ω–æ–≤–ª—ë–Ω Capacitor Bluetooth Service** (`src/utils/capacitor-bluetooth.ts`)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ `buildUDS()`, `ackUOKS()`, `ackUOKP()`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ ACK –Ω–∞ –∫–∞–¥—Ä—ã 0x66 –∏ 0x77
- ‚úÖ –°–±–æ—Ä –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 50 HEX –∫–∞–¥—Ä–æ–≤
- ‚úÖ Callback –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –∫–∞–¥—Ä–æ–≤
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ UDS –∫–æ–º–∞–Ω–¥ —Å SID

### 4. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω Live HEX Monitor –≤ Diagnostics** (`src/pages/Diagnostics.tsx`)
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω–∞—Ç–∏–≤–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ (Android/iOS)
- ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ —ç–∫—Ä–∞–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### 5. **–û–±–Ω–æ–≤–ª—ë–Ω Android Manifest** (`android/app/src/main/AndroidManifest.xml`)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è Android 12+:
  - `BLUETOOTH_CONNECT` ‚Äî –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º
  - `BLUETOOTH_SCAN` ‚Äî –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤
  - `BLUETOOTH` –∏ `BLUETOOTH_ADMIN` (–¥–ª—è Android ‚â§ 30)
  - `ACCESS_FINE_LOCATION` –∏ `ACCESS_COARSE_LOCATION`
- ‚úÖ –û–±—ä—è–≤–ª–µ–Ω–∞ feature `android.hardware.bluetooth`

## üìã –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Classic Bluetooth SPP** (Serial Port Profile) —á–µ—Ä–µ–∑ `@e-is/capacitor-bluetooth-serial`
- **UUID SPP**: `00001101-0000-1000-8000-00805F9B34FB`
- **–ü—Ä–æ—Ç–æ–∫–æ–ª**: –∫–∞–¥—Ä—ã 0x88/0x66/0x77 + UDS-–ø–æ–¥–æ–±–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
- **–ê–¥—Ä–µ—Å–∞—Ü–∏—è**:
  - –û—Ç–ø—Ä–∞–≤–∫–∞: DST=0x28 (–±–ª–æ–∫), SRC=0xF0 (—Ç–µ—Å—Ç–µ—Ä)
  - –ü—Ä–∏—ë–º: DST=0xF1 (—Ç–µ—Å—Ç–µ—Ä), SRC=0x28 (–±–ª–æ–∫)

## üéØ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü–∞—Ä—Å–∏–Ω–≥ –∫–∞–¥—Ä–æ–≤
```typescript
// 0x88: [0x88] [screen] [len] [payload...] [CHK]
// 0x66: [0x66] ['S'] ['C'] ['R'] ['_'] [n] ‚Äî –ë–ï–ó CHK!
// 0x77: [0x77] [n_pak] [n_byte+1] [payload...] [CHK]
// UDS:  [HDR] [DST] [SRC] [SID] [DATA...] [CHK]
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–≤–µ—Ç—ã
- **0x66** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è `UOKS<n>`
- **0x77** ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è `UOKP<n>`

### Keep-Alive
- –ö–∞–∂–¥—ã–µ 1.5 —Å–µ–∫—É–Ω–¥—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è `TesterPresent` (SID 0x3E, –¥–∞–Ω–Ω—ã–µ 0x01)

## üîß –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:
1. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ GitHub
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `git pull`
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm install`
4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `npx cap sync android`
5. –°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ: `npx cap run android`

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- ‚úÖ –ö–∞–¥—Ä—ã 0x66 **–ù–ï –∏–º–µ—é—Ç** –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å—É–º–º—ã
- ‚úÖ UDS –æ—Ç–≤–µ—Ç—ã –ø—Ä–∏—Ö–æ–¥—è—Ç —Å DST=0xF1, SRC=0x28
- ‚úÖ –ü–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –∑–∞–ø—Ä–æ—Å–æ–º –≤—ã–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ø–∞—É–∑–∞ 150ms
- ‚úÖ Live HEX Monitor —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω–∞—Ç–∏–≤–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö (Android/iOS)

## üìä –°—Ç–∞—Ç—É—Å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

- ‚úÖ Android 12+ (—á–µ—Ä–µ–∑ –Ω–æ–≤—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è BLUETOOTH_CONNECT/SCAN)
- ‚úÖ Android ‚â§ 11 (—á–µ—Ä–µ–∑ legacy —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è BLUETOOTH/ADMIN)
- ‚úÖ Classic Bluetooth SPP (RFCOMM)
- ‚úÖ –ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ "–ì–ª–∞–≤–Ω–æ–µ.docx" –∏ "–∏–∑–º–µ–Ω–µ–Ω–∏—è.docx"
