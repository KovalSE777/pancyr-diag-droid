/**
 * Константы для Bluetooth протокола
 * 
 * НОВЫЙ ПРОТОКОЛ (на основе анализа оригинального приложения DB_BluetoothMonitorS):
 * 
 * Команды:
 * - UCONF: ASCII "UCONF" (5 байт) - запрос конфигурации экранов
 * - UOKS: ASCII "UOKS" + screenId (5 байт) - подтверждение смены экрана
 * - UOKP: ASCII "UOKP" + pktId (5 байт) - подтверждение пакета конфигурации
 * - Циклический опрос: 38 байт (0x44 0x04 0x07 ... + checksum)
 * 
 * Формат ответов от БСКУ:
 * - Заголовок синхронизации: 0xFF × 7 байт
 * - Тип/ScreenId: 1 байт (0x01, 0x04, 0x66, 0x77)
 * - Данные телеметрии: переменная длина
 * 
 * АЛЬТЕРНАТИВНЫЙ РЕЖИМ (Direct Control):
 * - Прямое управление через байты команд (если основной протокол не работает)
 */

// Тайминги и интервалы (в миллисекундах)
export const BT_TIMING = {
  // Пауза после подключения перед отправкой первой команды
  CONNECTION_STABILIZATION_DELAY: 200,
  
  // Интервал опроса состояния устройства (бывший PERIODIC_READ_INTERVAL)
  PERIODIC_READ_INTERVAL: 1000,
  
  // Интервал опроса данных в UI
  UI_POLLING_INTERVAL: 2000,
  
  // Задержка перед редиректом после успешного подключения
  REDIRECT_DELAY: 1200,
} as const;

// Адреса (используются только в альтернативном режиме Direct Control)
export const PROTOCOL_ADDRESSES = {
  BSKU: 0x2A,          // Адрес БСКУ (получатель команд)
  TESTER: 0xF1,        // Адрес тестера/приложения (отправитель команд)
  EXPECTED_DST: 0xF1,  // Ожидаемый адрес назначения в ответах (тестер)
  EXPECTED_SRC: 0x2A,  // Ожидаемый адрес источника в ответах (БСКУ)
} as const;

/**
 * АЛЬТЕРНАТИВНЫЙ РЕЖИМ: ФОРМАТ ПАКЕТА ПРЯМОГО УПРАВЛЕНИЯ
 * (Используется только если основной протокол с ASCII командами не работает)
 * 
 * Формат: [HDR, DST=0x2A, SRC=0xF1, iUPR_BT, iUPR_IND, iDAT_BIT, dlt_paus, CHK]
 * 
 * iUPR_BT (байт управления реле):
 *   bit 0: M1, bit 1: M2, bit 2: M3, bit 3: M4, bit 4: M5, bit 5: CMP
 * 
 * Ответ устройства (22 байта телеметрии):
 * [HDR, DST=0xF1, SRC=0x2A, 0x61, 0x01, ...22 байта данных, CHK]
 */

export const UDS_ADDRESSES = PROTOCOL_ADDRESSES;

// Лимиты хранения данных
export const DATA_LIMITS = {
  MAX_HEX_FRAMES: 100,  // Максимальное количество hex-фреймов в памяти
  MAX_LOG_ENTRIES: 100, // Максимальное количество записей в логе
} as const;

// PIN-код для Bluetooth (из документации)
export const BT_DEFAULT_PIN = '1234';
