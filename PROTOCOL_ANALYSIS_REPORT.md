# –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–∏—Å—Ç–µ–º—ã PancyrDiag ‚Äî –û—Ç—á–µ—Ç –æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (v1.0)

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 17.10.2025  
**–í–µ—Ä—Å–∏—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏:** v1.0 (17.10.2025)  
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

---

## üìã –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ–∑—é–º–µ

–ü—Ä–æ–≤–µ–¥–µ–Ω –ø–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Android-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è PancyrDiag –ø—Ä–æ—Ç–∏–≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç 17.10.2025. –í—ã—è–≤–ª–µ–Ω—ã **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è** –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª–µ UDS, –º–∞–ø–ø–∏–Ω–≥–µ –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–∞–¥—Ä–æ–≤.

### –ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Ö–æ–¥–∫–∏:

‚úÖ **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏:**
- Bluetooth SPP —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç (UUID `00001101-0000-1000-8000-00805F9B34FB`)
- –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ UDS-–∫–∞–¥—Ä–æ–≤
- –ú–µ—Ö–∞–Ω–∏–∑–º TesterPresent
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —ç–∫—Ä–∞–Ω–æ–≤ 0x66/0x77

‚ùå **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è:**
- **UDS –∞–¥—Ä–µ—Å–∞—Ü–∏—è:** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç DST=0x28, —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç DST=0x2A
- **Payload –º–∞–ø–ø–∏–Ω–≥:** –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–∞–Ω–Ω—ã—Ö (22 –±–∞–π—Ç–∞ vs —Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
- **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:** –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ (26-33 –±–∞–π—Ç–∞)
- **Checksum:** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ (sum8 vs –º–ª–∞–¥—à–∏–π –±–∞–π—Ç —Å—É–º–º—ã)

---

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º

### 1. Bluetooth Transport Layer

#### üìÑ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (–¢–ó ¬ß1):
```
–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç: Bluetooth SPP (RFCOMM)
UUID: 00001101-0000-1000-8000-00805F9B34FB
PIN: 1234 (—Å–æ–ø—Ä—è–∂–µ–Ω–∏–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Android)
–ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ connect: ~200 –º—Å
```

#### üíª –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

**–§–∞–π–ª:** `src/utils/native-bluetooth.ts`
```typescript
export const SPP_UUID = '00001101-0000-1000-8000-00805F9B34FB'; // ‚úÖ OK

async connect(mac: string): Promise<void> {
  await BluetoothSerial.connect({ mac, uuid: SPP_UUID });
}
```

**–§–∞–π–ª:** `android/app/src/main/java/com/koval/pancyr/bt/BluetoothSerialPlugin.kt`
```kotlin
private val sppUUID = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB") // ‚úÖ OK
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É 200 –º—Å –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –∫–æ–º–∞–Ω–¥ (—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è, —Å—Ö–µ–º–∞ 1).

---

### 2. UDS Addressing

#### üìÑ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (–¢–ó ¬ß1, ¬ß2):
```
–ê–¥—Ä–µ—Å–∞ –≤ –æ—Ç–≤–µ—Ç–∞—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:
- DST (–ø–æ–ª—É—á–∞—Ç–µ–ª—å): 0xF1 (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
- SRC (–∏—Å—Ç–æ—á–Ω–∏–∫): 0x2A (–ë–°–ö–£)

–ó–∞–ø—Ä–æ—Å—ã –æ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
- SRC: 0xF1 (—Ç–µ—Å—Ç–µ—Ä)
- DST: 0x2A (–ë–°–ö–£)

‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –Ω–∞ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ç–∫–∞—Ö –ø—Ä–æ—à–∏–≤–∫–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å 0x28, –Ω–æ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è ‚Äî 0x2A
```

#### üíª –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

**–§–∞–π–ª:** `src/utils/protocol-parser.ts`
```typescript
function buildUDS(dst = 0x28, src = 0xF0, sid: number, data: number[] = []): Uint8Array {
  // ‚ùå –û–®–ò–ë–ö–ê: dst –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0x28, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 0x2A
  // ‚ùå –û–®–ò–ë–ö–ê: src –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0xF0, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 0xF1
  const len = 3 + data.length;
  const hdr = [0x80 + len, dst, src, sid];
  const body = [...hdr, ...data];
  const cs = sum8(new Uint8Array(body));
  return new Uint8Array([...body, cs]);
}
```

**–§–∞–π–ª:** `src/utils/capacitor-bluetooth.ts`
```typescript
private async sendStartCommunication() {
  const cmd = buildUDS(0x28, 0xF0, 0x81, []); // ‚ùå –û–®–ò–ë–ö–ê
}

private async sendTesterPresent() {
  const cmd = buildUDS(0x28, 0xF0, 0x3E, [0x01]); // ‚ùå –û–®–ò–ë–ö–ê
}

private async requestDiagnosticData() {
  const cmd = buildUDS(0x28, 0xF0, 0x21, [0x01]); // ‚ùå –û–®–ò–ë–ö–ê
}
```

**–°—Ç–∞—Ç—É—Å:** ‚ùå **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –†–ê–°–•–û–ñ–î–ï–ù–ò–ï**

**–í–ª–∏—è–Ω–∏–µ:** –í—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.

**–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```typescript
// protocol-parser.ts
function buildUDS(dst = 0x2A, src = 0xF1, sid: number, data: number[] = []): Uint8Array {
  // ...
}
```

---

### 3. Checksum Algorithm

#### üìÑ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (–¢–ó ¬ß1):
```
–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞: —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –±–∞–π—Ç –∫–∞–¥—Ä–∞, 
–≤ –∫–æ–Ω—Ü–µ –∫–∞–¥—Ä–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –º–ª–∞–¥—à–∏–π –±–∞–π—Ç —Å—É–º–º—ã.
```

#### üíª –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

**–§–∞–π–ª:** `src/utils/protocol-parser.ts`
```typescript
function sum8(a: Uint8Array, n?: number): number {
  let s = 0;
  const len = n !== undefined ? n : a.length;
  for (let i = 0; i < len; i++) s += a[i];
  return s & 0xFF; // ‚úÖ –ú–ª–∞–¥—à–∏–π –±–∞–π—Ç
}
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢** (–ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –±–∞–π—Ç–∞–º –∫–∞–¥—Ä–∞)

**–ó–∞–º–µ—á–∞–Ω–∏–µ:** –í —Ñ—É–Ω–∫—Ü–∏–∏ `buildUDS` checksum –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ ‚Äî sum8 –æ—Ç –≤—Å–µ–≥–æ body.

---

### 4. Payload Mapping (22 –±–∞–π—Ç–∞)

#### üìÑ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (–¢–ó ¬ß2, –¢–∞–±–ª–∏—Ü–∞ –º–∞–ø–ø–∏–Ω–≥–∞):

**–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –Ω–∞ 0x21 0x01:**
```
–ó–∞–≥–æ–ª–æ–≤–æ–∫ (5 –±–∞–π—Ç):
[0] 0x80 + (–¥–ª–∏–Ω–∞)
[1] 0xF1 (DST ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
[2] 0x2A (SRC ‚Äî –ë–°–ö–£)
[3] 0x61 (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç)
[4] 0x01 (LocalIdentifier)

Payload (Data[0..21], 22 –±–∞–π—Ç–∞):
Data[0]  = U_U_UM1         // –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ M1 (–∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä), ADC 0-255
Data[1]  = U_U_UM2         // –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ M2 (–∏—Å–ø–∞—Ä–∏—Ç–µ–ª—å), ADC
Data[2]  = U_U_UM3         // –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ M3 (–∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä), ADC
Data[3]  = U_U_FU          // –≠—Ç–∞–ª–æ–Ω/–ø–∏—Ç–∞–Ω–∏–µ (~27–í), ADC
Data[4]  = uUPR_BT         // –ú–∞—Å–∫–∞ —Ä–µ–ª–µ M1..M5, CMP
Data[5]  = uUPR_IND        // –ú–∞—Å–∫–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ IND1..IND4
Data[6]  = sDAT_BIT        // –°—Ç–∞—Ç—É—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏
Data[7]  = work_rej_cmp    // –†–µ–∂–∏–º –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞
Data[8]  = vdlt_cnd_i      // dUM1 cnd (–ø—Ä–æ—Å–∞–¥–∫–∞ –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä)
Data[9]  = vdlt_isp_i      // dUM2 isp (–ø—Ä–æ—Å–∞–¥–∫–∞ –∏—Å–ø–∞—Ä–∏—Ç–µ–ª—å)
Data[10] = vdlt_cmp_i      // dUM3 cmp (–ø—Ä–æ—Å–∞–¥–∫–∞ –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä)
Data[11] = timer_off       // –¢–∞–π–º–µ—Ä –≤—ã–∫–ª—é—á–µ–Ω–∏—è
Data[12] = rej_cnd         // –†–µ–∂–∏–º –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä–∞
Data[13] = rej_isp         // –†–µ–∂–∏–º –∏—Å–ø–∞—Ä–∏—Ç–µ–ª—è
Data[14] = edlt_cnd        // –ó–∞–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä–∞
Data[15] = edlt_isp        // –ó–∞–¥–µ—Ä–∂–∫–∞ –∏—Å–ø–∞—Ä–∏—Ç–µ–ª—è
Data[16] = edlt_cmp        // –ó–∞–¥–µ—Ä–∂–∫–∞ –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä–∞
Data[17] = n_V_cnd         // –°—á—ë—Ç—á–∏–∫ –≤–∫–ª—é—á–µ–Ω–∏–π –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä–∞
Data[18] = PWM_spd         // PWM —Å–∫–æ—Ä–æ—Å—Ç—å
Data[19] = s1_TMR2         // –°—Ç–∞—Ä—à–∏–π –±–∞–π—Ç TMR2
Data[20] = s0_TMR2         // –ú–ª–∞–¥—à–∏–π –±–∞–π—Ç TMR2
Data[21] = t_v_razg_cnd    // –í—Ä–µ–º—è —Ä–∞–∑–≥–æ–Ω–∞ –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä–∞
```

**–§–æ—Ä–º—É–ª—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ (–¢–ó ¬ß2):**
```
U [–í] = ADC * 30 / 255
T [¬∞C] = (ADC - 128) / 2   // –¥–ª—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä
P [–∫–ü–∞] = ADC * K_p        // –¥–ª—è –¥–∞–≤–ª–µ–Ω–∏—è
```

#### üíª –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

**–§–∞–π–ª:** `src/utils/screen4-parser.ts`
```typescript
export function parseScreen4(payload: Uint8Array): DiagnosticData | null {
  if (payload.length < 22) return null;
  
  const d = payload; // Data –º–∞—Å—Å–∏–≤
  
  // ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –º–∞–ø–ø–∏–Ω–≥ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–µ–π!
  
  const U_UM1 = d[0]; // ‚úÖ –°–æ–≤–ø–∞–¥–∞–µ—Ç
  const U_UM2 = d[1]; // ‚úÖ –°–æ–≤–ø–∞–¥–∞–µ—Ç
  const U_UM3 = d[2]; // ‚úÖ –°–æ–≤–ø–∞–¥–∞–µ—Ç
  const U_FU = d[3];  // ‚úÖ –°–æ–≤–ø–∞–¥–∞–µ—Ç
  
  // –ü—Ä–æ–±–ª–µ–º–∞: –¥–∞–ª—å–Ω–µ–π—à–µ–µ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–æ–≤–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
  // –¢–µ–∫—É—â–∏–π –∫–æ–¥ –¥–µ–∫–æ–¥–∏—Ä—É–µ—Ç —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç
}
```

**–§–∞–π–ª:** `src/utils/bluetooth-parser.ts` (—Å—Ç–∞—Ä—ã–π –ø–∞—Ä—Å–µ—Ä)
```typescript
// ‚ö†Ô∏è –≠—Ç–æ—Ç —Ñ–∞–π–ª –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –º–∞–ø–ø–∏–Ω–≥
// –ù—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–æ–≤–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
```

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ß–ê–°–¢–ò–ß–ù–û–ï –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï**

**–ü—Ä–æ–±–ª–µ–º—ã:**
1. –ú–∞–ø–ø–∏–Ω–≥ –∏–Ω–¥–µ–∫—Å–æ–≤ 8-21 –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–æ–≤–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
2. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π `timer_off`, `rej_cnd`, `rej_isp`, `edlt_*`, `n_V_cnd`, `PWM_spd`, `s*_TMR2`
3. –§–æ—Ä–º—É–ª—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è

---

### 5. –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (26-33 –±–∞–π—Ç–∞)

#### üìÑ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (–°—Ö–µ–º–∞ –æ–±–º–µ–Ω–∞ ¬ß4):
```
–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–±—É–¥—É—â–µ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ):
Data[22] = T_air         // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–∑–¥—É—Ö–∞
Data[23] = T_isp         // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∏—Å–ø–∞—Ä–∏—Ç–µ–ª—è
Data[24] = U_davl        // –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–∞ –¥–∞–≤–ª–µ–Ω–∏—è
Data[25] = iSOST_UPR1    // –°–æ—Å—Ç–æ—è–Ω–∏–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è 1
Data[26] = iSOST_UPR2    // –°–æ—Å—Ç–æ—è–Ω–∏–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è 2
```

#### üíª –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

**–°—Ç–∞—Ç—É—Å:** ‚ùå **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤ –ø–∞—Ä—Å–µ—Ä–µ –¥–ª—è –±—É–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏–π –ø—Ä–æ—à–∏–≤–∫–∏.

---

### 6. Frame Types Processing

#### üìÑ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (–°—Ö–µ–º–∞ –æ–±–º–µ–Ω–∞ ¬ß3, ¬ß5, ¬ß6):

**0x88 (Telemetry):**
```
Deprecated –∏–ª–∏ —Å–ª—É–∂–µ–±–Ω—ã–π —Ñ—Ä–µ–π–º
–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 0x21 0x01 (UDS ReadDataByLocalIdentifier)
```

**0x66 (Screen Notification):**
```
ECU ‚Üí App: "SCR_" + <screenId> (–±–∞–π—Ç)
App ‚Üí ECU: "UOKS" + <screenId> (–±–∞–π—Ç)

‚ö†Ô∏è –í–ê–ñ–ù–û: screenId –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –±–∞–π—Ç–æ–º (0x04), –∞ –Ω–µ ASCII —Å–∏–º–≤–æ–ª–æ–º ('4' = 0x34)!
```

**0x77 (Configuration):**
```
ECU ‚Üí App: –ø–∞–∫–µ—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ [pktId, len, data..., crc]
App ‚Üí ECU: "UOKP" + <pktId> (–±–∞–π—Ç)
```

#### üíª –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

**–§–∞–π–ª:** `src/utils/protocol-parser.ts`
```typescript
class ProtocolParser {
  feed(chunk: Uint8Array, emit: (f: ParsedFrame) => void) {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ 0x88, 0x66, 0x77, 0x80 (UDS)
    // ‚úÖ –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
  }
}
```

**–§–∞–π–ª:** `src/utils/capacitor-bluetooth.ts`
```typescript
private handleParsedFrame(frame: ParsedFrame) {
  if (frame.type === 'SCR_66') {
    // ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ª–∏ screenId –∫–∞–∫ –±–∞–π—Ç –∏–ª–∏ ASCII?
    logService.add('[BT] Screen notification received', 'info');
  }
  if (frame.type === 'CFG_77') {
    // ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ª–∏ pktId –∫–∞–∫ –±–∞–π—Ç?
    logService.add('[BT] Config packet received', 'info');
  }
}
```

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–¢–†–ï–ë–£–ï–¢ –ü–†–û–í–ï–†–ö–ò**

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ –∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–°—Ö–µ–º–∞ ¬ß5):**
> "–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ; —Å–∏–º–≤–æ–ª '4' (0x34) –Ω–µ —Ä–∞–≤–µ–Ω –±–∞–π—Ç—É 0x04."

–ù—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç **–±–∞–π—Ç**, –∞ –Ω–µ ASCII-–∫–æ–¥.

---

### 7. Timing Requirements

#### üìÑ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:
```
- –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—Å–ª–µ connect: ~200 –º—Å
- TesterPresent: –∫–∞–∂–¥—ã–µ ~1.5 —Å–µ–∫
- ReadData (0x21 0x01): –∫–∞–∂–¥—É—é ~1 —Å–µ–∫
- –¢–∞–π–º–∞—É—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤: 500-1000 –º—Å
- –û—Ç–≤–µ—Ç –Ω–∞ 0x66/0x77: –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ (< 100 –º—Å)
```

#### üíª –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

**–§–∞–π–ª:** `src/utils/bluetooth-constants.ts`
```typescript
export const BT_TIMING = {
  CONNECT_DELAY: 200,
  TESTER_PRESENT_INTERVAL: 1500,
  DATA_REQUEST_INTERVAL: 1000,
  READ_TIMEOUT: 1000,
  RESPONSE_TIMEOUT: 500
};
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢**

---

### 8. Initialization Sequence

#### üìÑ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (–°—Ö–µ–º–∞ –æ–±–º–µ–Ω–∞ ¬ß2):
```
sequenceDiagram
App->>ECU: StartCommunication (SID 0x81)
ECU-->>App: PositiveResponse (0xC1)
App->>ECU: StartDiagnosticSession (0x10 ...)
ECU-->>App: PositiveResponse (0x50 ...)
App->>ECU: TesterPresent (0x3E 0x01)
```

#### üíª –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

**–§–∞–π–ª:** `src/utils/capacitor-bluetooth.ts`
```typescript
async connectToDeviceId(deviceAddress: string, systemType: SystemType) {
  // ...
  await this.sendStartCommunication(); // 0x81 ‚úÖ
  setTimeout(() => {
    this.startTesterPresent(); // 0x3E 0x01 ‚úÖ
    this.startPeriodicRead();  // 0x21 0x01 ‚úÖ
  }, 300);
}

private async sendStartCommunication() {
  const cmd = buildUDS(0x28, 0xF0, 0x81, []); // ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–µ –∞–¥—Ä–µ—Å–∞
  await this.sendRaw(cmd);
}
```

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ß–ê–°–¢–ò–ß–ù–û–ï –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï**

**–ü—Ä–æ–±–ª–µ–º—ã:**
1. –ê–¥—Ä–µ—Å–∞ –≤ UDS –∫–æ–º–∞–Ω–¥–∞—Ö –Ω–µ–≤–µ—Ä–Ω—ã–µ (0x28/0xF0 –≤–º–µ—Å—Ç–æ 0x2A/0xF1)
2. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —è–≤–Ω—ã–π `StartDiagnosticSession (0x10)`
3. –¢–∞–π–º–∞—É—Ç 300 –º—Å (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 200 –º—Å —Å–æ–≥–ª–∞—Å–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏)

---

## üîß –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã):

#### 1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å UDS –∞–¥—Ä–µ—Å–∞—Ü–∏—é
**–§–∞–π–ª:** `src/utils/protocol-parser.ts`
```typescript
// –ë–´–õ–û:
function buildUDS(dst = 0x28, src = 0xF0, sid: number, data: number[] = []): Uint8Array

// –î–û–õ–ñ–ù–û –ë–´–¢–¨:
function buildUDS(dst = 0x2A, src = 0xF1, sid: number, data: number[] = []): Uint8Array
```

#### 2. –û–±–Ω–æ–≤–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥ payload (22 –±–∞–π—Ç–∞)
**–§–∞–π–ª:** `src/utils/screen4-parser.ts`

–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –º–∞–ø–ø–∏–Ω–≥ —Å–æ–≥–ª–∞—Å–Ω–æ —Ç–∞–±–ª–∏—Ü–µ –∏–∑ –¢–ó ¬ß2.

#### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É screenId/pktId –∫–∞–∫ –±–∞–π—Ç–æ–≤
**–§–∞–π–ª—ã:** –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ 0x66 –∏ 0x77

–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è **–±–∞–π—Ç** (0x04), –∞ –Ω–µ ASCII ('4' = 0x34).

---

### üü° –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—É–ª—É—á—à–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏):

#### 4. –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É 200 –º—Å –ø–æ—Å–ª–µ connect
**–§–∞–π–ª:** `src/utils/capacitor-bluetooth.ts`
```typescript
async connectToDeviceId(deviceAddress: string, systemType: SystemType) {
  await this.bt.connect(deviceAddress);
  await new Promise(resolve => setTimeout(resolve, 200)); // –î–æ–±–∞–≤–∏—Ç—å!
  await this.sendStartCommunication();
}
```

#### 5. –î–æ–±–∞–≤–∏—Ç—å StartDiagnosticSession (0x10)
–°–æ–≥–ª–∞—Å–Ω–æ —Å—Ö–µ–º–µ –æ–±–º–µ–Ω–∞ ¬ß2, –ø–æ—Å–ª–µ 0x81 –¥–æ–ª–∂–Ω–∞ –∏–¥—Ç–∏ –∫–æ–º–∞–Ω–¥–∞ 0x10.

#### 6. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (26+ –±–∞–π—Ç)
–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–∞—Ä—Å–µ—Ä –∫ –±—É–¥—É—â–∏–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º –ø—Ä–æ—à–∏–≤–∫–∏.

---

### üü¢ –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç—ã):

#### 7. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- `BLUETOOTH_INTEGRATION.md` ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å –Ω–æ–≤–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- `ARCHITECTURE.md` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥
- –°–æ–∑–¥–∞—Ç—å `PROTOCOL_SPEC.md` ‚Äî —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é

#### 8. –î–æ–±–∞–≤–∏—Ç—å —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã
- –¢–µ—Å—Ç—ã –Ω–∞ buildUDS —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏
- –¢–µ—Å—Ç—ã –Ω–∞ parseScreen4 —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –¢–µ—Å—Ç—ã –Ω–∞ checksum

---

## üìä –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –§–∞–π–ª—ã |
|-----------|-------------|----------------------|-------|
| Bluetooth SPP UUID | ‚úÖ OK | - | `native-bluetooth.ts`, `BluetoothSerialPlugin.kt` |
| UDS Addressing | ‚ùå FAIL | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π | `protocol-parser.ts`, `capacitor-bluetooth.ts` |
| Checksum | ‚úÖ OK | - | `protocol-parser.ts` |
| Payload 22 –±–∞–π—Ç–∞ | ‚ö†Ô∏è Partial | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π | `screen4-parser.ts` |
| –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç | ‚ùå Missing | üü° –í—ã—Å–æ–∫–∏–π | `screen4-parser.ts` |
| Frame 0x66/0x77 | ‚ö†Ô∏è Check | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π | `capacitor-bluetooth.ts` |
| Timing | ‚úÖ OK | üü¢ –ù–∏–∑–∫–∏–π | `bluetooth-constants.ts` |
| Init sequence | ‚ö†Ô∏è Partial | üü° –í—ã—Å–æ–∫–∏–π | `capacitor-bluetooth.ts` |

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é

### –≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 —á–∞—Å–∞)
1. –ò–∑–º–µ–Ω–∏—Ç—å –∞–¥—Ä–µ—Å–∞ –≤ `buildUDS` –Ω–∞ 0x2A/0xF1
2. –û–±–Ω–æ–≤–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥ –≤ `screen4-parser.ts`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–π—Ç–æ–≤—É—é –æ—Ç–ø—Ä–∞–≤–∫—É –≤ 0x66/0x77

### –≠—Ç–∞–ø 2: –°—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è (2-4 —á–∞—Å–∞)
4. –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É 200 –º—Å
5. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å 0x10 StartDiagnosticSession
6. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞

### –≠—Ç–∞–ø 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (4-8 —á–∞—Å–æ–≤)
7. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º
8. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–∞–¥—Ä–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
9. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Å–µ—Å—Å–∏—è—Ö

### –≠—Ç–∞–ø 4: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (2-3 —á–∞—Å–∞)
10. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å—é —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
11. –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∫–∞–¥—Ä–æ–≤ (request/response)
12. –î–æ–±–∞–≤–∏—Ç—å troubleshooting guide

---

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚úÖ 100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ v1.0 –æ—Ç 17.10.2025
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω—ã–π –æ–±–º–µ–Ω —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –∫–∞–¥—Ä–æ–≤
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –≤—Å–µ—Ö 22 –±–∞–π—Ç payload
- ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É (26-33 –±–∞–π—Ç–∞)
- ‚úÖ –ü–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

## üìé –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### A. –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π UDS-–∫–∞–¥—Ä (–ø—Ä–∏–º–µ—Ä)

**–ó–∞–ø—Ä–æ—Å ReadDataByLocalIdentifier (0x21 0x01):**
```
[0x84, 0x2A, 0xF1, 0x21, 0x01, CS]
      ^^^^  ^^^^  ^^^^  ^^^^
      DST   SRC   SID   Data

0x84 = 0x80 + len(4)
0x2A = DST (–ë–°–ö–£)
0xF1 = SRC (—Ç–µ—Å—Ç–µ—Ä)
0x21 = ReadDataByLocalIdentifier
0x01 = LocalIdentifier
CS   = checksum (–º–ª–∞–¥—à–∏–π –±–∞–π—Ç —Å—É–º–º—ã –≤—Å–µ—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö)
```

**–û—Ç–≤–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (22 –±–∞–π—Ç–∞ –¥–∞–Ω–Ω—ã—Ö):**
```
[0x9B, 0xF1, 0x2A, 0x61, 0x01, D0, D1, ..., D21, CS]
      ^^^^  ^^^^  ^^^^  ^^^^
      DST   SRC   Resp  LID

0x9B = 0x80 + len(27): 5 –±–∞–π—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ + 22 –¥–∞–Ω–Ω—ã—Ö
0xF1 = DST (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
0x2A = SRC (–ë–°–ö–£)
0x61 = –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ 0x21
0x01 = LocalIdentifier
D0..D21 = 22 –±–∞–π—Ç–∞ –¥–∞–Ω–Ω—ã—Ö (—Å–º. –º–∞–ø–ø–∏–Ω–≥)
CS = checksum
```

### B. –°—Å—ã–ª–∫–∏ –Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

- **–û—Å–Ω–æ–≤–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:** `–°—Ö–µ–º—ã_–û–±–º–µ–Ω–∞_Pancyr_Diag_‚Äî_Bluetooth_uds_—ç–∫—Ä–∞–Ω—ã_v1.docx`
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ:** `–¢–∑_–î–ª—è_–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞_Pancyr_Diag_Android_‚Äî_–ü—Ä–æ—Ç–æ–∫–æ–ª_–ú–∞–ø–ø–∏–Ω–≥_–ò_–°–±–æ—Ä–∫–∞_v1.0_17.10.docx`
- **–¢–µ–∫—É—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** `BLUETOOTH_INTEGRATION.md`, `ARCHITECTURE.md`

---

**–ö–æ–Ω–µ—Ü –æ—Ç—á–µ—Ç–∞**

**–ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª:** AI Assistant  
**–î–∞—Ç–∞:** 17.10.2025  
**–í–µ—Ä—Å–∏—è –æ—Ç—á–µ—Ç–∞:** 1.0
